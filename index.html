<!doctype html><meta http-equiv="content-type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="manifest" href="manifest.webmanifest"><link rel="apple-touch-icon" href="apple-touch-icon.png"><title>Colloscope</title><style>*{box-sizing:border-box}body,html{margin:0;padding:0}body{font-family:Roboto,sans-serif;line-height:1.6}.name-form,.student-info,.week,p{margin:2em 0}.container{max-width:70em;margin:0 auto;padding:4em 1em}.title{margin:0 0 1em 0;font-size:2em}.class-select{font-size:1em;font-weight:700}.name-input{margin:.45em 0 0 0;font-size:1em;padding:.4em}.loading--hidden{display:none}.student-info,.weeks .week:last-child{margin-bottom:0}.student-info--hidden{display:none}.weeks{margin:2em 0}.week__title{margin:1em 0}.week__colles{list-style-type:none;margin:-.5em;padding:0}.colle{margin:.5em;display:inline-block;width:18em;padding:1em;border-style:solid;border-width:.3em;border-radius:.5em}.colle--waiting{border-color:#000}.colle--subject-0{background-color:#376a8b;border-color:#083757;color:#fff}.colle--subject-1{background-color:#34714d;border-color:#073d1e;color:#fff}.colle--subject-2{background-color:#9b3838;border-color:#570808;color:#fff}.colle--subject-3{background-color:#af2fd0;border-color:#6c0094;color:#fff}.colle--done{opacity:.7}.colle--sson{border-color:#e5ff00}.colle__info,.colle__subject{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.colle__subject{font-weight:700}.data-credits--header{margin:2.5em 0 0 0}.data-credits--header,.data-credits--list{font-size:.8em}.data-credits--list{margin:0}.data-credits--name{font-style:italic}.data-credits__hidden{display:none}@media (max-width:30em){body{text-align:center}.week__colles{margin:-.5em 0}.colle{width:100%;margin:.5em 0}.data-credits--list{text-align:left}}@media (prefers-color-scheme:dark){body{background-color:#121314;color:#fff}}</style><div class="container"><h1 class="title">Colloscope <select id="class-select" class="class-select" aria-label="Classe"><option value="mpsi1">MPSI1<option value="mpsi2">MPSI2<option value="mpsi3">MPSI3<option value="mp-star">MP*<option value="psi-star">PSI*</select></h1><noscript><p><strong>Votre navigateur ne supporte pas le JavaScript.</strong><br>Afin d'accéder aux colles, vous pouvez soit :<ul><li>Activer le JavaScript (si c'est possible).<li>Accéder à une version simplifiée de cette application qui ne nécessite pas le JavaScript en cliquant sur <a href="light/">ce lien</a>.</ul></noscript><form class="name-form"><label for="name-input">Entrez votre nom :</label><br><input id="name-input" class="name-input" type="text" placeholder="e.g. Jean Dupont"></form><p id="loading" class="loading--hidden"><strong>Chargement des données en cours...</strong><div id="student-info" class="student-info student-info--hidden"><p class="student-info-fields">Nom : <strong id="student-name"></strong><br>Groupe de colle : <strong id="student-group-number"></strong><div id="student-colles-weeks" class="weeks" aria-label="Semaines de colles"></div><p class="data-credits--header">Personne(s) ayant participé à l'importation et la correction des données :<ul id="data-credits-list" class="data-credits--list"></ul></div></div><script>"use strict";var l={},r=6e4,d=60*r,o=24*d;function i(e){return e.getHours()*d+e.getMinutes()*r+e.getSeconds()}function c(e,t){var n=t.valueOf()-e.valueOf(),a=Math.abs(n);function s(e,t){var n="";return n+=0<e?"dans ":"il y a ",n+=Math.abs(e),n+=" ",n+=t,1<Math.abs(e)&&(n+="s"),n}if(a<r)return"maintenant";if(a<2*d)return s(Math.round(n/r),"minute");a=Math.trunc(n/o),e=i(e),t=i(t);return 0<n&&t<e?a++:n<0&&e<t&&a--,0===a?s(Math.round(n/d),"heure"):-2===a?"avant-hier":-1===a?"hier":1===a?"demain":2===a?"après-demain":s(a,"jour")}var u=/\W/;function h(e){return(e=e.trim().toLowerCase()).normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function m(e,t){e=e.slice(),t=t.slice();for(var n=0;0<e.length;){for(var a=e.pop(),s=-1,r=1/0,d=0;d<t.length;d++){var l=t[d];l.length<r&&!l.indexOf(a)&&(s=d,r=l.length)}if(-1===s)return 0;n+=a.length,t.splice(s,1)}return n}function f(e,t,n){this.classData=e,this.group=t,this.index=n}function p(e,t){var n=h(t).split(u);n.sort(function(e,t){return e.length-t.length});for(var a=-1,s=0,r=0,d=0;d<e.searchIndex.length;d++){var l=m(n,e.searchIndex[d].tokens);s<l?(a=d,s=l,r=0):l===s&&r++}if(-1===a||0<r)return null;t=e.searchIndex[a];return new f(e,t.group,t.index)}f.prototype.getName=function(){return this.classData.groups[this.group].students[this.index]},f.prototype.getId=function(){return 1e6*this.classData.id+1e3*this.group+this.index};var g={classSelect:document.getElementById("class-select"),nameInput:document.getElementById("name-input"),loading:document.getElementById("loading"),studentInfo:document.getElementById("student-info"),studentName:document.getElementById("student-name"),studentGroupNumber:document.getElementById("student-group-number"),collesWeeks:document.getElementById("student-colles-weeks"),dataCredits:document.getElementById("data-credits-list")},v={selectedClass:null,loadingHidden:!0,studentInfoHidden:!0,studentId:null,dataCreditsDirty:!0};function t(){g.classSelect.addEventListener("change",function(e){var t=g.classSelect.value;void 0!==window.localStorage&&localStorage.setItem("class",t),v.selectedClass!==t&&(a(v.selectedClass=t).then(function(){v.selectedClass===t&&(v.dataCreditsDirty=!0,n())}),n())}),g.nameInput.addEventListener("input",function(e){void 0!==window.localStorage&&localStorage.setItem("name",g.nameInput.value),n()})}function C(e,t){var n=document.createElement("li");n.classList.add("colle"),n.classList.add("colle--"+t.state),n.classList.add("colle--subject-"+t.subject);var a=document.createElement("p");a.classList.add("colle__subject"),a.textContent=e.subjects[t.subject],n.appendChild(a);var s=["Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"][t.day],a=document.createElement("p");return a.classList.add("colle__info"),a.appendChild(document.createTextNode(e.teachers[t.teacher])),void 0!==t.room&&(a.appendChild(document.createElement("br")),a.appendChild(document.createTextNode("Salle "+t.room))),a.appendChild(document.createElement("br")),a.appendChild(document.createTextNode(s+" à "+t.startTime.getHours()+" h ("+c(new Date,t.startTime)+")")),n.appendChild(a),n}function I(e,t){var n=document.createElement("section");n.classList.add("week");var a=document.createElement("h1");a.classList.add("week__title"),a.textContent="Semaine "+(t.index+1)+" ("+t.day+"/"+t.month+")",n.appendChild(a);var s=document.createElement("ul");s.classList.add("week__colles");for(var r=0;r<t.colles.length;r++)s.appendChild(C(e,t.colles[r]));return n.appendChild(s),n}function w(e){var t=document.createElement("li");return t.classList.add("data-credits--name"),t.innerText=e,t}function y(e,t){for(var n=[],a=new Date,s=e.groups[t].weeks,r=0;r<s.length;r++){var d=e.weeks[r].split("-"),l=parseInt(d[0]),o=parseInt(d[1]),i=parseInt(d[2]),c=[];n.push({colles:c,index:r,day:i,month:o});for(var u=0;u<s[r].length;u++){var h=s[r][u],m=e.colles[h],f=new Date(l,o-1,i,m.time);f.setDate(f.getDate()+m.day),h=36e5<a.valueOf()-f.valueOf()?"done":36e5<=f.valueOf()-a.valueOf()?"soon":"waiting",c.push({startTime:f,state:h,day:m.day,subject:m.subject,teacher:m.teacher,room:m.room})}}return n}function n(){var e=l[v.selectedClass],t=void 0!==e||""==g.nameInput.value.trim();t!==v.loadingHidden&&(t?g.loading.classList.add("loading--hidden"):g.loading.classList.remove("loading--hidden"),v.loadingHidden=t);var n=void 0===e?null:p(e,g.nameInput.value),t=null===n;if(t!==v.studentInfoHidden&&(t?g.studentInfo.classList.add("student-info--hidden"):g.studentInfo.classList.remove("student-info--hidden"),v.studentInfoHidden=t),!t){t=n.getId();if(t!==v.studentId){g.studentName.textContent=n.getName(),g.studentGroupNumber.textContent=n.group+e.firstGroup;for(var a=(a=y(e,n.group)).filter(function(e){return e.colles.some(function(e){return"done"!==e.state})});null!==g.collesWeeks.firstChild;)g.collesWeeks.removeChild(g.collesWeeks.firstChild);for(var s=0;s<a.length;s++)g.collesWeeks.appendChild(I(e,a[s]));v.studentId=t}if(v.dataCreditsDirty){for(;null!==g.dataCredits.firstChild;)g.dataCredits.removeChild(g.dataCredits.firstChild);for(s=0;s<e.credits.length;s++)g.dataCredits.appendChild(w(e.credits[s]));v.dataCreditsDirty=!1}}}var k={},E=0;function a(d){return void 0!==l[d]?Promise.resolve():void 0!==k[d]?new Promise(function(e,t){k[d].push(e)}):new Promise(function(e,t){var r=[];r.push(e),k[d]=r,fetch("data/"+d+".json").then(function(e){if(!e.ok)throw Error("response is not OK");return e.json()}).then(function(e){var t=e;t.id=E++,t.searchIndex=[];for(var n=0;n<t.groups.length;n++)for(var a=t.groups[n].students,s=0;s<a.length;s++)t.searchIndex.push({tokens:h(a[s]).split(u),group:n,index:s});l[d]=t;for(n=0;n<r.length;n++)r[n]();k[d]=null}).catch(function(e){console.error("failed to load data",e)})})}function s(){var e;void 0!==window.localStorage&&(null!==(e=localStorage.getItem("class"))&&(g.classSelect.value=e,v.selectedClass=e),null!==(e=localStorage.getItem("name"))&&(g.nameInput.value=e,n())),null===v.selectedClass&&(v.selectedClass=g.classSelect.value)}function e(){s();var e=v.selectedClass;a(e).then(function(){v.selectedClass===e&&n()}),t()}function x(t){void 0===Math.trunc&&(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)});for(var e=[{check:window.Promise,url:"https://cdn.jsdelivr.net/npm/promise-polyfill@8.1.3/dist/polyfill.min.js"},{check:window.fetch,url:"https://cdn.jsdelivr.net/npm/whatwg-fetch@3.4.1/dist/fetch.umd.js"},{check:String.prototype.normalize,url:"https://cdn.jsdelivr.net/npm/unorm@1.6.0/lib/unorm.js"}],n=0,a=0;a<e.length;a++){var s,r=e[a];void 0===r.check&&((s=document.createElement("script")).src=r.url,s.onload=function(e){0===--n&&t()},s.onerror=function(e){console.error("failed to load polyfill",e)},document.head.appendChild(s),n++)}0===n&&t()}function b(){var e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap",document.head.appendChild(e)}b(),x(e),"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js").then(function(){console.log("successfully registered service worker")})</script>